<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Calculadora de gastos compartidos para viajes. Gestiona viajes, salidas y gastos entre personas.">
  <title>Divide â€” Gastos compartidos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=DM+Serif+Display&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="app">
    <header class="header">
      <div class="header-top">
        <div>
          <h1 class="logo">Divide</h1>
          <p class="tagline">Gastos compartidos</p>
        </div>
        <div class="currency-selector-wrapper">
          <label for="currencySelect" class="currency-label">Moneda</label>
          <select id="currencySelect" class="currency-select" aria-label="Seleccionar moneda">
            <option value="COP" selected>ğŸ‡¨ğŸ‡´ Peso colombiano- COP</option>
            <option value="USD">ğŸ‡ºğŸ‡¸ DÃ³lar - USD</option>
            <option value="EUR">ğŸ‡ªğŸ‡º Euro - EUR</option>
          </select>
        </div>
      </div>
    </header>

    <!-- Vista: Lista de viajes -->
    <section class="trips-list-section" id="tripsListSection">
      <div class="card card-accent">
        <h2>Mis viajes</h2>
        <p class="section-desc">Crea un viaje para gestionar salidas y gastos compartidos.</p>
        <div class="trip-create-form">
          <input type="text" id="tripNameInput" placeholder="Nombre del viaje" aria-label="Nombre del viaje" autocomplete="off">
          <button type="button" class="btn btn-primary" id="createTripBtn">Crear viaje</button>
        </div>
        <ul class="trips-list" id="tripsList"></ul>
        <p class="hint" id="tripsListHint">No tienes viajes. Crea uno para empezar.</p>
      </div>
    </section>

    <!-- Vista: Detalle del viaje -->
    <section class="trip-detail-section" id="tripDetailSection" hidden>
      <nav class="breadcrumb">
        <button type="button" class="breadcrumb-link" id="backToTripsBtn">â† Viajes</button>
        <span class="breadcrumb-sep">/</span>
        <span class="breadcrumb-current" id="tripNameBreadcrumb"></span>
      </nav>

      <div class="app-grid">
        <!-- Personas del viaje -->
        <section class="participants-section card card-accent">
          <div class="section-badge">Paso 1</div>
          <h2>Personas del viaje</h2>
          <p class="section-desc">AÃ±ade a todas las personas que participan en el viaje.</p>
          <div class="participant-input">
            <input type="text" id="participantName" placeholder="Nombre" aria-label="Nombre" autocomplete="off">
            <button type="button" class="btn btn-primary" id="addParticipant">AÃ±adir</button>
          </div>
          <ul class="participants-tags" id="participantsTags"></ul>
          <p class="hint" id="participantsHint">AÃ±ade al menos 2 personas</p>
        </section>

        <!-- Salidas -->
        <section class="outings-section card">
          <div class="section-badge">Paso 2</div>
          <div class="outings-header">
            <h2>Salidas</h2>
            <button type="button" class="btn btn-primary btn-sm" id="addOutingBtn">+ Nueva salida</button>
          </div>
          <p class="section-desc">Cada salida puede tener distintas personas. Solo participan en los gastos quienes estÃ©n en esa salida.</p>
          <div class="outings-list" id="outingsList"></div>
          <p class="hint" id="outingsHint">AÃ±ade salidas (cena, taxi, entradas...) y selecciona quiÃ©n participÃ³ en cada una.</p>
        </section>

        <!-- Resumen del viaje -->
        <section class="results-section card card-results">
          <div class="section-badge">Resumen del viaje</div>
          <h2>Â¿QuiÃ©n paga a quiÃ©n?</h2>
          <div class="results-content" id="resultsContent">
            <p class="empty-state" id="emptyResults">AÃ±ade personas, salidas y gastos para ver el resumen.</p>
            <div class="settlement-details" id="settlementDetails" hidden>
              <div class="results-preview" id="resultsPreview">
                <div class="total-summary">
                  <p><strong>Total del viaje:</strong> <span id="totalAmount">0</span></p>
                </div>
                <div class="balances" id="balancesList"></div>
                <h3>Transferencias a realizar</h3>
                <ul class="settlements" id="settlementsList"></ul>
              </div>
            </div>
          </div>
          <div class="export-actions" id="exportActions" hidden>
            <button type="button" class="btn btn-secondary" id="exportImage">Descargar imagen</button>
            <button type="button" class="btn btn-secondary" id="exportPdf">Descargar PDF</button>
          </div>
        </section>
      </div>
    </section>
  </main>

  <!-- Modal: Nueva salida -->
  <div class="modal-overlay" id="outingModalOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="outingModalTitle">
      <h3 id="outingModalTitle">Nueva salida</h3>
      <input type="text" id="outingNameInput" placeholder="Ej: Cena, Taxi, Entradas..." aria-label="Nombre de la salida">
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" id="cancelOutingBtn">Cancelar</button>
        <button type="button" class="btn btn-primary" id="confirmOutingBtn">Crear</button>
      </div>
    </div>
  </div>

  <!-- Comprobante para exportar -->
  <div class="comprobante" id="comprobante">
    <div class="comprobante-inner">
      <div class="comprobante-header">
        <span class="comprobante-logo">Divide</span>
        <span class="comprobante-subtitle" id="comprobanteSubtitle">Resumen del viaje</span>
      </div>
      <div class="comprobante-divider"></div>
      <div class="comprobante-totals">
        <div class="comprobante-total-row">
          <span>Total del viaje</span>
          <span id="comprobanteTotal">0</span>
        </div>
      </div>
      <div class="comprobante-divider"></div>
      <div class="comprobante-balances" id="comprobanteBalances"></div>
      <div class="comprobante-divider"></div>
      <div class="comprobante-settlements">
        <h4 class="comprobante-section-title">Transferencias a realizar</h4>
        <ul class="comprobante-settlements-list" id="comprobanteSettlementsList"></ul>
      </div>
      <div class="comprobante-footer">
        <span class="comprobante-date" id="comprobanteDate"></span>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
